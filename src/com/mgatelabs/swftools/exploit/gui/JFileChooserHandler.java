package com.mgatelabs.swftools.exploit.gui;

import com.mgatelabs.swftools.support.filters.CommonFileFilter;
import com.mgatelabs.swftools.support.tools.FileNameHelper;

import javax.swing.*;
import java.io.File;

public class JFileChooserHandler {
    private JFileChooser myJFileChooser;

    private String defaultExt, defaultDescription;

    private String myExt, myDescription;

    private JFrame masterFrame;

    public JFileChooserHandler(JFrame master, JFileChooser aJFileChooser, String aExt, String ADescription) {
        myJFileChooser = aJFileChooser;
        defaultExt = aExt;
        defaultDescription = ADescription;

        setup(defaultExt, defaultDescription);

        masterFrame = master;
    }

    public File getSaveFile(String ext, String description) {
        setup(ext, description);

        File aFile = getSaveFile();

        setup(defaultExt, defaultDescription);

        return aFile;
    }

    public File getSaveFile() {
        int returnVal = myJFileChooser.showSaveDialog(masterFrame);
        if (returnVal == JFileChooser.APPROVE_OPTION) {
            File destination = myJFileChooser.getSelectedFile();
            destination = FileNameHelper.checkFile(destination, myExt);
            return destination;
        } else {
            return null;
        }
    }

    public File getOpenFile(String ext, String description) {
        setup(ext, description);

        File aFile = getOpenFile();

        setup(defaultExt, defaultDescription);

        return aFile;
    }

    public File getOpenFile() {
        int returnVal = myJFileChooser.showOpenDialog(masterFrame);
        if (returnVal == JFileChooser.APPROVE_OPTION) {
            File destination = myJFileChooser.getSelectedFile();
            //destination = FileNameHelper.checkFile(destination,myExt);
            return destination;
        } else {
            return null;
        }
    }

    private void setup(String ext, String description) {
        myExt = ext;
        myDescription = description;

        myJFileChooser.resetChoosableFileFilters();
        myJFileChooser.setFileFilter(new CommonFileFilter(ext, description));
    }

}