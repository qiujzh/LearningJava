/*
    Copyright M-Gate Labs 2007
*/

/**
 <p>
 <b>Graph Link List</b>
 </p>
 <p>
 Used to keep track of linked lists.
 </p>
 */

package com.mgatelabs.swftools.exploit.conversion;

import com.mgatelabs.swftools.exploit.render.AdvancedPath;

public class AdvPathLinkList {
    private AdvPathLink root;
    private AdvPathLink tail;
    private int mySize;

    public AdvPathLinkList() {
        root = null;
        tail = null;
        mySize = 0;
    }

    public int size() {
        return mySize;
    }

    public AdvPathLink getRoot() {
        return root;
    }

    public AdvPathLink add(AdvancedPath aPath) {
        AdvPathLink result = new AdvPathLink(aPath);
        mySize++;

        if (root == null) {
            root = result;
            tail = result;
        } else if (root != null) {
            tail.next = result;
            result.prev = tail;
            tail = result;
        }

        return result;
    }

    public AdvPathLink addBefore(AdvPathLink parent, AdvancedPath aPath) {
        AdvPathLink result = new AdvPathLink(aPath);
        mySize++;

        if (parent == root) { // Replace Root
            result.next = root;
            root.prev = result;
            root = result;
        } else { // More to do
            result.prev = parent.prev;
            result.next = parent;
            result.prev.next = result;
            result.next.prev = result;
        }

        return result;
    }

    public void remove(AdvPathLink aLink) {
        AdvPathLink aPrev = aLink.prev;
        AdvPathLink aNext = aLink.next;
        mySize--;

        // Destroy my links
        aLink.prev = null;
        aLink.next = null;

        // Deal with prev first
        if (aPrev != null) {
            aPrev.next = aNext;
        } else // Removing the root node
        {
            root = aNext;
        }

        if (aNext != null) {
            aNext.prev = aPrev;
        } else // Removing the tree node
        {
            tail = aPrev;
        }
    }
}